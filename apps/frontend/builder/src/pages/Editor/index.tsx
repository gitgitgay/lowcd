/*
 *   Copyright (c) 2024 Â¶ôÁ†ÅÂ≠¶Èô¢ @Heyi
 *   All rights reserved.
 *   Â¶ôÁ†ÅÂ≠¶Èô¢ÂÆòÊñπÂá∫ÂìÅÔºå‰ΩúËÄÖ @HeyiÔºå‰æõÂ≠¶ÂëòÂ≠¶‰π†‰ΩøÁî®ÔºåÂèØÁî®‰ΩúÁªÉ‰π†ÔºåÂèØÁî®‰ΩúÁæéÂåñÁÆÄÂéÜÔºå‰∏çÂèØÂºÄÊ∫ê„ÄÇ
 */
import { useEffect } from 'react'

import { EditorCanvas } from '@/components/EditorCanvas'
import { EditorLeftPanel } from '@/components/EditorLeftPanel'
import { EditorNavigator } from '@/components/EditorNavigator'
import { EditorSettingPanel } from '@/components/EditorSettingPanel'
import { BlockProtocol } from '@/protocols/block'
import { useBlockStore } from '@/stores/useBlockStore'

type BlockTreeNode = Pick<BlockProtocol, 'id' | 'type'> & { children?: BlockTreeNode[] }
const blockTree: BlockTreeNode[] = [
    {
        id: 'container-xfg1ge',
        type: 'container',
        children: [
            {
                id: 'text-xfg1ge',
                type: 'text',
            },
            {
                id: 'icon-gaw1ge',
                type: 'icon',
            },
            {
                id: 'button-xfg1ge',
                type: 'button',
            },
        ],
    },
    {
        id: 'text-fga1ge',
        type: 'text',
    },
    {
        id: 'container-gaw1ge',
        type: 'container',
        children: [
            {
                id: 'text-gaw1ge',
                type: 'text',
            },
            {
                id: 'image-gaw1ge',
                type: 'image',
            },
            {
                id: 'divider-gaw1ge',
                type: 'divider',
            },
            {
                id: 'button-gaw1ge',
                type: 'button',
            },
        ],
    },
    {
        id: 'container-xag1fa',
        type: 'container',
        children: [
            {
                id: 'text-xag1fa',
                type: 'text',
            },
        ],
    },
]

const blocks: Record<string, BlockProtocol> = {
    'container-xfg1ge': {
        id: 'container-xfg1ge',
        title: 'ÂÆπÂô®1',
        type: 'container',
        props: {
            layout: {
                flexDirection: 'row',
                justifyContent: 'flex-start',
                alignItems: 'center',
            },
            size: {
                width: 100,
                widthUnit: '%',
                height: 500,
                heightUnit: 'px',
            },
        },
    },
    'text-xfg1ge': {
        id: 'text-xfg1ge',
        title: 'ÊñáÊú¨1',
        type: 'text',
        props: {
            text: '‰ºöÂΩìÂáåÁªùÈ°∂Ôºå‰∏ÄËßà‰ºóÂ±±Â∞è',
            size: {
                width: 200,
                widthUnit: 'px',
                height: 100,
                heightUnit: '%',
            },
        },
    },
    'icon-gaw1ge': {
        id: 'icon-gaw1ge',
        title: 'ÂõæÊ†á1',
        type: 'icon',
        props: {
            icon: 'üöÄ',
            size: {
                width: 'auto',
                height: 'auto',
            },
        },
    },
    'button-xfg1ge': {
        id: 'button-xfg1ge',
        title: 'ÊåâÈíÆ1',
        type: 'button',
        props: {
            text: 'ÁÇπÂáªÊàë',
            size: {
                width: 'auto',
                height: 'auto',
            },
        },
    },
    'text-fga1ge': {
        id: 'text-fga1ge',
        title: 'ÊñáÊú¨2',
        type: 'text',
        props: {
            text: 'ÈùûÂ∏∏Ê£íÁöÑÔºåÈùûÂ∏∏ Nice',
            size: {
                width: 100,
                widthUnit: '%',
                height: 100,
                heightUnit: '%',
            },
        },
    },
    'container-gaw1ge': {
        id: 'container-gaw1ge',
        title: 'ÂÆπÂô®2',
        type: 'container',
        props: {
            layout: {
                flexDirection: 'column',
                justifyContent: 'flex-start',
                alignItems: 'center',
            },
            size: {
                width: 500,
                widthUnit: 'px',
                height: 300,
                heightUnit: 'px',
            },
        },
    },
    'text-gaw1ge': {
        id: 'text-gaw1ge',
        title: 'ÊñáÊú¨3',
        type: 'text',
        props: {
            text: 'Hello, World!',
            size: {
                width: 100,
                widthUnit: 'px',
                height: 100,
                heightUnit: 'px',
            },
        },
    },
    'image-gaw1ge': {
        id: 'image-gaw1ge',
        title: 'ÂõæÁâá1',
        type: 'image',
        props: {
            src: 'https://docs.pmnd.rs/_next/static/media/zustand-icon.3261dd51.svg',
            size: {
                width: 150,
                widthUnit: 'px',
                height: 150,
                heightUnit: 'px',
            },
        },
    },
    'divider-gaw1ge': {
        id: 'divider-gaw1ge',
        title: 'ÂàÜÂâ≤Á∫ø1',
        type: 'divider',
        props: {
            size: {
                width: 100,
                widthUnit: '%',
                height: 1,
                heightUnit: 'px',
            },
        },
    },
    'button-gaw1ge': {
        id: 'button-gaw1ge',
        title: 'ÊåâÈíÆ2',
        type: 'button',
        props: {
            text: 'ÁÇπÂáªÊàë',
            size: {
                width: 'auto',
                height: 'auto',
            },
        },
    },
    'container-xag1fa': {
        id: 'container-xag1fa',
        title: 'ÂÆπÂô®',
        type: 'container',
        props: {
            layout: {
                flexDirection: 'row',
                justifyContent: 'flex-start',
                alignItems: 'center',
            },
            size: {
                width: 100,
                widthUnit: '%',
                height: 500,
                heightUnit: 'px',
            },
        },
    },
    'text-xag1fa': {
        id: 'text-xag1fa',
        title: 'ÊñáÊú¨',
        type: 'text',
        props: {
            text: 'ÊñáÊú¨',
            size: {
                width: 200,
                widthUnit: 'px',
                height: 100,
                heightUnit: '%',
            },
        },
    },
}

// const blocks: BlockProtocol[] = [
//     {
//         id: 'container-xfg1ge',
//         title: 'ÂÆπÂô®1',
//         type: 'container',
//         props: {
//             layout: {
//                 flexDirection: 'row',
//                 justifyContent: 'space-between',
//                 alignItems: 'center',
//             },
//             size: {
//                 width: 100,
//                 widthUnit: '%',
//                 height: 100,
//                 heightUnit: '%',
//             },
//         },
//         children: [
//             {
//                 id: 'text-xfg1ge',
//                 title: 'ÊñáÊú¨1',
//                 type: 'text',
//                 props: {
//                     text: '‰ºöÂΩìÂáåÁªùÈ°∂Ôºå‰∏ÄËßà‰ºóÂ±±Â∞è',
//                     size: {
//                         // width: 100,
//                         // widthUnit: '%',
//                         // height: 100,
//                         // heightUnit: '%',
//                         width: 'auto',
//                         height: 200,
//                         heightUnit: 'px',
//                     },
//                 },
//             },
//             {
//                 id: 'icon-gaw1ge',
//                 title: 'ÂõæÊ†á1',
//                 type: 'icon',
//                 props: {
//                     icon: 'üöÄ',
//                 },
//             },
//             {
//                 id: 'button-xfg1ge',
//                 title: 'ÊåâÈíÆ1',
//                 type: 'button',
//                 props: {
//                     text: 'ÁÇπÂáªÊàë',
//                 },
//             },
//         ],
//     },
//     {
//         id: 'text-fga1ge',
//         title: 'ÊñáÊú¨2',
//         type: 'text',
//         props: {
//             text: 'ÈùûÂ∏∏Ê£íÁöÑÔºåÈùûÂ∏∏ Nice',
//         },
//     },
//     {
//         id: 'container-gaw1ge',
//         title: 'ÂÆπÂô®2',
//         type: 'container',
//         props: {
//             layout: {
//                 flexDirection: 'column',
//                 justifyContent: 'flex-start',
//                 alignItems: 'center',
//             },
//             size: {
//                 width: 100,
//                 widthUnit: '%',
//                 height: 100,
//                 heightUnit: '%',
//             },
//         },
//         children: [
//             {
//                 id: 'text-gaw1ge',
//                 title: 'ÊñáÊú¨3',
//                 type: 'text',
//                 props: {
//                     text: 'Hello, World!',
//                     size: {
//                         width: 100,
//                         widthUnit: '%',
//                         height: 100,
//                         heightUnit: '%',
//                     },
//                 },
//             },
//             {
//                 id: 'image-gaw1ge',
//                 title: 'ÂõæÁâá1',
//                 type: 'image',
//                 props: {
//                     src: 'https://via.placeholder.com/150',
//                     size: {
//                         width: 150,
//                         widthUnit: 'px',
//                         height: 150,
//                         heightUnit: 'px',
//                     },
//                 },
//             },
//             {
//                 id: 'divider-gaw1ge',
//                 title: 'ÂàÜÂâ≤Á∫ø1',
//                 type: 'divider',
//                 props: {
//                     size: {
//                         width: 100,
//                         widthUnit: '%',
//                         height: 1,
//                         heightUnit: 'px',
//                     },
//                 },
//             },
//             {
//                 id: 'button-gaw1ge',
//                 title: 'ÊåâÈíÆ2',
//                 type: 'button',
//                 props: {
//                     text: 'ÁÇπÂáªÊàë',
//                 },
//             },
//         ],
//     },
// ]

export function Editor() {
    const initBlocks = useBlockStore(state => state.initBlocks)
    const initBlockTree = useBlockStore(state => state.initBlockTree)

    useEffect(() => {
        initBlockTree(blockTree)
        initBlocks(blocks)
    }, [initBlockTree, initBlocks])

    return (
        <div className="h-full">
            <EditorNavigator />
            <div className="flex flex-row h-[calc(100%-46px)]">
                <EditorLeftPanel />
                <EditorCanvas />
                <EditorSettingPanel />
            </div>
        </div>
    )
}
